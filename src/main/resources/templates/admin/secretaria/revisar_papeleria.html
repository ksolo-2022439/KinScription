<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/admin_layout}">
<head>
    <title>Revisar Papelería</title>
</head>
<body>
<main layout:fragment="content">
    <a th:href="@{/admin/secretaria/papeleria}" class="back-link">&larr; Volver a la Lista</a>
    <header class="admin-header">
        <h1>Revisión de Papelería</h1>
        <p>Participante: <strong th:text="${participante.nombreCompleto} + ' ' + ${participante.apellidos}"></strong></p>
    </header>

    <div class="document-viewer-grid">
        <div class="admin-card">
            <h3>Documentos Subidos</h3>
            <ul class="document-action-list">
                <li th:each="doc : ${documentos}">
                    <span th:text="${doc.nombreDocumento}"></span>
                    <button class="btn-secondary view-pdf-btn" th:data-url="@{/uploads/{filename}(filename=${doc.urlArchivo})}">
                        Ver Documento
                    </button>
                </li>
            </ul>
            <hr>
            <h3>Acciones</h3>
            <div class="action-buttons">
                <form th:action="@{/admin/secretaria/papeleria/aprobar}" method="post">
                    <input type="hidden" name="participanteId" th:value="${participante.id}" />
                    <button type="submit" class="btn-primary">Aprobar Toda la Papelería</button>
                </form>
                <form th:action="@{/admin/secretaria/participante/rechazar}" method="post">
                    <input type="hidden" name="participanteId" th:value="${participante.id}" />
                    <input type="hidden" name="origen" value="papeleria" />
                    <button type="submit" class="btn-danger">Rechazar Proceso</button>
                </form>
            </div>
        </div>

        <div class="admin-card pdf-viewer-container">
            <div id="pdf-placeholder" class="pdf-placeholder">
                <p>Selecciona un documento de la lista para visualizarlo aquí.</p>
            </div>
            <iframe id="pdf-viewer" class="pdf-viewer" src="" title="Visor de Documentos"></iframe>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const viewButtons = document.querySelectorAll('.view-pdf-btn');
            const pdfViewer = document.getElementById('pdf-viewer');
            const pdfPlaceholder = document.getElementById('pdf-placeholder');

            viewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const pdfUrl = this.getAttribute('data-url');
                    pdfPlaceholder.style.display = 'none';
                    pdfViewer.style.display = 'block';
                    pdfViewer.setAttribute('src', pdfUrl);
                });
            });
        });
    </script>
</main>
</body>
</html>